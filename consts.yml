theme: COSMO

credentials: WEBFISH_CREDS
cred_profile_name: hpc-wasabi-user
endpoint_url: "https://s3.us-west-1.wasabisys.com"
region_name: us-west-1

master_root: /groups/CaiLab/analyses/
raw_master_root: /groups/CaiLab/personal/

sync_folder: monitoring/
analysis_folder: analyses/
raw_folder: raw/

dataset_root: "{user}/{dataset}/{analysis}"
raw_dataset_root: "{user}/raw/{dataset}/"

bucket_name: hpc-wasabi

local_store: webfish_data/

pages:
  datavis:
    generator_class: DatavisProcessing
    variables: [ "position", "channel" ]
    source_files:
      segmentation: "MMStack_Pos{position}/Segmentation/labeled_img.tif"
      dots_csv:
        "MMStack_Pos{position}/Segmentation/Channel_{channel}/gene_locations_assigned_to_cell.csv"
      dots_csv_unseg:
        "MMStack_Pos{position}/Decoded/Channel_{channel}/pre_seg_diff_1_minseeds_3_filtered.csv"
      cell_info:
        "MMStack_Pos{position}/Segmentation/Channel_{channel}/cell_info.csv"
      onoff_intensity_plot:
        "MMStack_Pos{position}/False_Positive_Rate_Analysis/Channel_{channel}/On-Off-Barcode-Intensity-Analysis.png"
      onoff_sorted_plot:
        "MMStack_Pos{position}/On_Off_Barcode_Plot/Channel_{channel}/On_Off_Sorted_Barcode_Plot.png"
      falsepositive_txt:
        "MMStack_Pos{position}/False_Positive_Rate_Analysis/Channel_{channel}/false_positives_after_segmentation.txt"

    output_files:
      mesh:
        pattern: "MMStack_Pos{position}/labeled_mesh.json"
        requires: ["segmentation"]
        generator: "generate_mesh"
      dots:
        pattern: "MMStack_Pos{position}/dots_um_with_colors.csv"
        requires: ["dots_csv | dots_csv_unseg"]
        generator: "generate_dots"

  dotdetection:
    variables: [ "hyb", "position" ]
    preupload_class: DotDetectionPreupload
    global_files:
      exp_tree: "monitoring/exp_tree.json"
    source_files:
      dot_locations: "MMStack_Pos{position}/Dot_Locations/locations.csv"
      avg_brightness: "MMStack_Pos{position}/Dot_Locations/Average_Brightness_Analysis.csv"
      biggest_jump: "MMStack_Pos{position}/Dot_Locations/Biggest_Jump_Histograms/HybCycle_{hyb}_Jump.png"
    raw_files:
      hyb_fov: "HybCycle_{hyb}/MMStack_Pos{position}.ome.tif"